@tailwind base;
@tailwind components;
@tailwind utilities;

/* ===== BRAND ===== */
@layer base {
  :root {
    --background: 222 47% 6%;
    --foreground: 210 40% 98%;
    --card: 225 25% 12%;
    --card-foreground: 210 40% 98%;
    --primary: 265 80% 56%;
    --primary-2: 295 75% 55%;
    --accent: 190 90% 50%;
    --secondary: 225 25% 12%;
    --secondary-foreground: 210 40% 98%;
    --muted: 217 18% 40%;
    --muted-foreground: 214 20% 70%;
    --ok: 150 62% 45%;
    --danger: 0 84% 60%;
    --border: 225 22% 18%;
    --ring: 265 80% 56%;
  }

  .light {
    --background: 0 0% 100%;
    --foreground: 222 47% 10%;
    --card: 0 0% 100%;
    --card-foreground: 222 47% 10%;
    --primary: 265 80% 56%;
    --primary-2: 295 75% 55%;
    --accent: 190 90% 50%;
    --secondary: 210 40% 96%;
    --secondary-foreground: 222 47% 15%;
    --muted: 215 18% 45%;
    --muted-foreground: 215 16% 47%;
    --ok: 150 62% 38%;
    --danger: 0 84% 48%;
    --border: 214 32% 91%;
    --ring: 265 80% 56%;
  }

  * { @apply border-border; }
  body {
    @apply bg-background text-foreground;
    font-feature-settings: "rlig" 1, "calt" 1;
    overscroll-behavior-y: contain;
    -webkit-tap-highlight-color: transparent;
  }

  html, body, #root { height: 100%; }
}

/* ===== UTILITIES ===== */
@layer utilities {
  .text-gradient {
    background: linear-gradient(135deg, hsl(var(--primary)), hsl(var(--primary-2)), hsl(var(--accent)));
    -webkit-background-clip: text; background-clip: text; color: transparent;
  }
  .glass { @apply bg-card/50 backdrop-blur-xl border border-white/10; }
  .glass-ink { @apply bg-secondary/60 backdrop-blur-xl border border-white/5; }

  /* Squircle bubble + beak */
  .bubble {
    border-radius: 22px;
    position: relative;
    isolation: isolate;
  }
  .bubble-user {
    color: white;
    background: linear-gradient(135deg, hsl(var(--primary)) 0%, hsl(var(--primary-2)) 60%, hsl(var(--accent)) 100%);
    box-shadow: 0 8px 24px rgba(139,92,246,.25);
  }
  .bubble-assistant {
    @apply glass-ink;
  }
  .bubble-user::after, .bubble-assistant::after {
    content:""; position:absolute; bottom:6px; width:14px; height:14px; transform: rotate(45deg);
  }
  .bubble-user::after { right:-6px; background: inherit; filter: brightness(0.98); }
  .bubble-assistant::after { left:-6px; background: hsl(var(--secondary)); opacity: .9; }

  /* Comet loader */
  .comet {
    position: relative; width: 64px; height: 6px; border-radius: 9999px; background: hsl(var(--muted))/20;
    overflow: hidden;
  }
  .comet::before {
    content:""; position:absolute; left:-20%; top:0; width:20%; height:100%;
    background: linear-gradient(90deg, transparent, hsl(var(--primary)), hsl(var(--accent)));
    animation: comet 1.1s linear infinite;
  }
  @keyframes comet { 0% { left:-30%; } 100% { left:110%; } }

  /* Ripple tap */
  .ripple { position: relative; overflow: hidden; }
  .ripple:after {
    content:""; position:absolute; inset:0; background: radial-gradient( circle at var(--x) var(--y), rgba(255,255,255,.25), transparent 45% );
    opacity: 0; transition: opacity .4s;
  }
  .ripple:active:after { opacity: 1; transition: 0s; }

  /* Code blocks */
  pre.code {
    @apply relative rounded-xl border border-border bg-secondary/60 p-3 text-sm overflow-x-auto;
  }
  .code-copy {
    @apply absolute top-2 right-2 px-2 py-1 text-xs rounded-md bg-background/70 border border-border;
  }

  /* Scrollbars */
  ::-webkit-scrollbar { width: 6px; height: 6px; }
  ::-webkit-scrollbar-thumb { background: hsl(var(--muted))/40; border-radius: 8px; }
}

/* iOS momentum */
.-webkit-overflow-scrolling-touch { -webkit-overflow-scrolling: touch; }
